# yaml-language-server: $schema=bundle-schema.json
bundle:
  name: awesome-dab-cicd-project

variables:
  dev-catalog:
    description: "Development catalog: dev and test only"
    default: dev_catalog_awesome_company
  
  dev-schema:
    description: "Development schema: dev and test only"
    default: dev_schema_awesome_company

  prod-catalog:
    description: "Production catalog"
    default: prod_catalog_awesome_company

  prod-schema:
    description: "Production schema"
    default: prod_schema_awesome_company

resources:
  pipelines:
    dlt-sensors-pipeline:
      # ${bundle.target}
      name: "DTL Sensors pipeline"
      continuous: false
      channel: "PREVIEW"
 
      libraries:
        - notebook:
            path: src/dlt-pipelines/notebook-etl.sql
      edition: "ADVANCED"

targets:
  dev:
    workspace:
      host: https://adb-984752964297111.11.azuredatabricks.net
    default: true
    mode: development
    
    resources:
      pipelines:
        dlt-sensors-pipeline:
          development: true
          photon: false
          catalog: ${var.dev-catalog}
          target: ${var.dev-schema}
          clusters:
            - label: "default"
              num_workers: 2

  prod:
    workspace:
      host: https://adb-984752964297111.11.azuredatabricks.net

    mode: production
    resources:
      pipelines:
        dlt-sensors-pipeline:
          development: false
          photon: true
          catalog: ${var.prod-catalog}
          target: ${var.prod-schema}

          clusters:
            - label: "default"
              num_workers: 4